<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ title }} ‚Äî Linglong</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='index.css') }}" />
  </head>

  <body class="onboarding-page">
    <div class="onboarding-bg" aria-hidden="true"></div>
    <main class="onboarding-card onboarding-card--wide">
      <h1 class="onboarding-card__title">Customize Your Experience.</h1>
      <p class="onboarding-card__subtitle">Accessibility settings so everyone can lock in.</p>
      <ul class="customize-list">
        <li class="customize-item customize-item--parent" id="deafItem">
          <div class="customize-item__row" id="deafRow" role="button" tabindex="0" aria-expanded="false" aria-controls="deafSub">
            <span class="customize-item__icon" aria-hidden="true">ü¶ª</span>
            <div class="customize-item__text">
              <span class="customize-item__label">Deaf / Hard of Hearing</span>
              <span class="customize-item__desc">Listening questions disabled. Visual cues enhanced.</span>
            </div>
            <span class="customize-item__chevron" aria-hidden="true">‚ñº</span>
            <button type="button" class="toggle toggle--on" id="deafToggle" aria-pressed="true"><span class="toggle__thumb"></span></button>
          </div>
          <div class="customize-sub" id="deafSub" hidden>
            <div class="customize-item customize-item--sub">
              <span class="customize-item__icon" aria-hidden="true">üîá</span>
              <div class="customize-item__text">
                <span class="customize-item__label">Turn off Speaking Questions</span>
              </div>
              <button type="button" class="toggle" id="speakingToggle" aria-pressed="false"><span class="toggle__thumb"></span></button>
            </div>
          </div>
        </li>
        <li class="customize-item">
          <span class="customize-item__icon" aria-hidden="true">üëÅ</span>
          <div class="customize-item__text">
            <span class="customize-item__label">Blind / Low Vision</span>
            <span class="customize-item__desc">Reading mode disabled. Auto TTS enabled.</span>
          </div>
          <button type="button" class="toggle toggle--on" aria-pressed="true"><span class="toggle__thumb"></span></button>
        </li>
        <li class="customize-item">
          <span class="customize-item__icon" aria-hidden="true">üé§</span>
          <div class="customize-item__text">
            <span class="customize-item__label">Mute / Speech Impaired</span>
            <span class="customize-item__desc">Speaking questions disabled.</span>
          </div>
          <button type="button" class="toggle toggle--on" aria-pressed="true"><span class="toggle__thumb"></span></button>
        </li>
      </ul>
      <p class="customize-note"><img src="{{ url_for('static', filename='linglong/neutral.png') }}" alt="" class="customize-note__img" /> Everyone can lock in here.</p>
      <a href="{{ url_for('pages.vibe') }}" class="onboarding-btn onboarding-btn--primary">NEXT: PICK YOUR VIBE ‚Üí</a>
    </main>
    <script>
      (function () {
        function setupToggle(btn) {
          if (!btn) return;
          btn.addEventListener("click", function (e) {
            e.stopPropagation();
            var on = btn.classList.toggle("toggle--on");
            btn.setAttribute("aria-pressed", on);
          });
        }
        document.querySelectorAll(".customize-item .toggle").forEach(setupToggle);

        var deafRow = document.getElementById("deafRow");
        var deafSub = document.getElementById("deafSub");
        if (deafRow && deafSub) {
          function toggleDeafSub() {
            deafSub.hidden = !deafSub.hidden;
            deafRow.setAttribute("aria-expanded", !deafSub.hidden);
          }
          deafRow.addEventListener("click", function (e) {
            if (e.target.closest(".toggle")) return;
            toggleDeafSub();
          });
          deafRow.addEventListener("keydown", function (e) {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              if (e.target.closest(".toggle")) return;
              toggleDeafSub();
            }
          });
        }
      })();
    </script>
  </body>
</html>
